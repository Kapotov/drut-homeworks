# Домашнее задание к занятию "Протокол OSPF. Метрика, зоны и суммаризация"

### Цель задания

Данное домашнее задание позволит научиться проектировать динамическую маршрутизацию больших размеров, правильно выбирать тип сети, манипулировать метрикой и управлять выбором лучшего маршрута. Данные знания очень важны для построения качественной и быстрой сети.  

В результате выполнения этого задания вы:

1) Научитесь проектировать мультизональную топологию в OSPF.
2) Научитесь управлять метрикой.
3) Научитесь определять и конфигурировать, какой тип сети необходим для соседства в OSPF.
4) Научитесь определять, какой маршрут будет установлен в таблице маршрутизации.
5) Научитесь определять, какой тип LSA используется для передачи данных о сети.

 
------

### Инструкция к выполнению домашнего задания

1. Сделайте копию [Шаблона для домашнего задания](https://docs.google.com/document/d/1youKpKm_JrC0UzDyUslIZW2E2bIv5OVlm_TQDvH5Pvs/edit) себе на Google Disk.
2. В названии файла введите корректное название лекции и вашу фамилию и имя.
3. Зайдите в “Настройки доступа” и выберите доступ “Просматривать могут все в Интернете, у кого есть ссылка”.
 Ссылка на инструкцию [Как предоставить доступ к файлам и папкам на Google Диске](https://support.google.com/docs/answer/2494822?hl=ru&co=GENIE.Platform%3DDesktop)
5. Скопируйте текст задания в свой документ.
6. Выполните домашнее задание, запишите ответы и приложите необходимые скриншоты в свой Google Doc.
7. Для проверки домашнего задания преподавателем отправьте ссылку на ваш документ в личном кабинете.
8. Любые вопросы по решению задач задавайте в чате учебной группы.

---

### Задание 1

Исходя из топологии на картинке, определите тип всех маршрутизаторов (internal, backbone, ABR).  
Файл с изначальной конфигурацией маршрутизаторов можете найти [здесь]( https://github.com/netology-code/drut-homeworks/blob/main/4-03/homework_4_3_routers_config.txt ) - 

![image](https://github.com/netology-code/drut-homeworks/blob/main/4-03.png)

*Приведите список маршрутизаторов R1, R2, R3, R4, R5, R6, R7 c указанием их типов.*
# Ответ

```
Исходя из предоставленной конфигурации OSPF маршрутизаторов, можно определить тип каждого маршрутизатора в этой топологии.

R1 –  Этот маршрутизатор находится только в зоне 0, поэтому он может быть классифицирован как  (backbone)

R2 – ABR (Area Border Router). Маршрутизатор R2 имеет интерфейсы в областях 0 и 3 OSPF, связывая эти области, поэтому он является маршрутизатором граничащим с областями (ABR).

R3 – ABR (Area Border Router). Маршрутизатор R3 также имеет интерфейсы в нескольких областях OSPF (0, 3 и 7), связывая их между собой, что делает его также ABR.

R4 – Этот маршрутизатор находится только в зоне 3, поэтому он может быть классифицирован как внутренний маршрутизатор (Internal).

R5 –  Этот маршрутизатор так же как R1 находится только в зоне 0, поэтому он может быть классифицирован как  (backbone)

R6 – (Internal). Маршрутизатор R6 имеет все свои интерфейсы в области 7 OSPF. Следовательно, он также может быть определен как (Internal).

R7 – (Internal). Маршрутизатор R7 имеет все свои интерфейсы в области 7 OSPF. Следовательно, он также может быть определен как (Internal).
```

---

### Задание 2

По топологии из Задания 1, определите метрику маршрута на маршрутизаторе R1 для сети 4.4.4.4/32 маршрутизатора R4 через путь R1-R2-R4 и R1-R3-R4. 

1) Какая метрика будет у данных маршрутов?
2) Какой или какие из этих маршрутов будут установлены в таблицу маршрутизатора R1? 
Для оптимальной передачи трафика, маршрут до 4.4.4.4 должен проходить только через R1-R3-R4. 
3) Является ли ситуация в таблице маршрутизации оптимальной? Если нет, то каким образом можно исправить ситуацию и на каких маршрутизаторах необходимо внести изменения?
На маршрутизаторах сделана конфигурация для анонса сети и установления соседства. Дополнительные настройки по умолчанию.

*Приведите ответы на вопросы в свободной форме. В вопросе 3, если необходима конфигурация на маршрутизаторах, то приведите команды, которые необходимо применить и на каких маршрутизаторах.*
```
На схеме представлена сеть с использованием протокола OSPF. Маршрутизаторы R1, R2, R3 и R4 участвуют в обмене маршрутами. Для сетей OSPF метрика маршрута основывается на стоимости (cost), которая по умолчанию рассчитывается как `10000000 / bandwidth_in_bps`.

1. Метрика маршрута на маршрутизаторе R1 для сети 4.4.4.4/32:
- Через путь R1-R2-R4:
  - R1-R2: `10000000 / 100000000` = 100
  - R2-R4: `10000000 / 1000000000` = 10
  - ИТОГО: 100 + 10 = 110

- Через путь R1-R3-R4:
  - R1-R3: `10000000 / 100000000` = 100
  - R3-R4: `10000000 / 1000000000` = 10
  - ИТОГО: 100 + 10 = 110

2. В таблице маршрутизации маршрутизатора R1 будут присутствовать оба маршрута, поскольку их метрика равна. OSPF в таком случае использует равнозначную балансировку нагрузки (Equal-cost multi-path, ECMP), если только не настроены дополнительные ограничения.

3. Таблица маршрутизации не оптимальна, поскольку трафик должен проходить только через маршрут R1-R3-R4. Чтобы исправить ситуацию, необходимо изменить стоимость интерфейсов так, чтобы путь через R3 был предпочтительнее. Например, можно увеличить стоимость интерфейса на маршрутизаторе R1, ведущего к R2.

Команды для маршрутизатора R1:
```
configure terminal
interface Gi0/0 (предполагаемый интерфейс к R2)
ip ospf cost 200
exit
```

Это повысит стоимость маршрута через R2, делая путь R1-R3-R4 предпочтительным.

Реальная конфигурация зависит от используемого оборудования и версии операционной системы маршрутизаторов. Команды 'configure terminal' и 'ip ospf cost' характерны для устройств Cisco.
```
### Задание 3 

По топологии из Задания 1, сеть 172.16.1.0/24 анонсируется в OSPF через R4 и R5. 
1) Какой путь или пути ( R1-R5, R1-R2-R4, R1-R3-R4)  выберет R1 для данного маршрута? Почему? Соседства между R4-R5 нет.
2) Какие метрики для данного маршрута будет у R1 для данного маршрута через каждый путь? Конфигурация по умолчанию.
3) Какие изменения конфигурации необходимо сделать, чтоб правильно учитывалась пропускная способность каждого линка на этих путях?  
4) После того, как будет учитываться правильно каждый линк, изменится ли ситуация с выбором маршрута на R1? Почему?
 
*Приведите ответы на вопросы в свободной форме. В вопросе 3, напишите точно какую/какие команды необходимо использовать на маршрутизаторах*
```
При наличии нескольких путей до сети 172.16.1.0/24, R1 выберет маршрут с наименьшей стоимостью (метрикой) в соответствии с протоколом OSPF. Путь через R1-R3-R4 будет иметь метрику, равную сумме метрик каждого отдельного интерфейса на этом пути, аналогично с путями R1-R2-R4 и R1-R5.

Если соседства между R4 и R5 нет, то R1 не будет иметь информации о сети 172.16.1.0/24 через R5. Поэтому он будет выбирать маршрут либо через R1-R2-R4, либо через R1-R3-R4, в зависимости от метрик, установленных на этих маршрутах.

Метрика для каждого маршрута будет равна сумме метрик всех интерфейсов на этом маршруте. По умолчанию, стоимость интерфейса OSPF основана на пропускной способности, и чем выше пропускная способность, тем ниже стоимость. Однако, если соседства между R4 и R5 нет, R1 не узнает о пути через R5, и, следовательно, не учтет его метрику.

Для правильного учета пропускной способности каждого линка на этих путях, необходимо использовать команды для настройки стоимости интерфейсов OSPF на маршрутизаторах R1, R2, R3, R4 и R5:

На примере маршрутизатора R1:

R1(config)# interface Gi0/0
R1(config-if)# ip ospf cost <значение метрики>


После правильного учета пропускной способности каждого линка, ситуация с выбором маршрута на R1 может измениться. Если метрика маршрута через R1-R3-R4 будет меньше, чем через R1-R2-R4, то R1 выберет путь через R1-R3-R4, так как это будет являться наименее затратным и более быстрым маршрутом.
```
## Дополнительные задания (со звездочкой*)

Эти задания дополнительные (не обязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.

### Задание 4*

По топологии из Задания 1, сеть 7.7.7.7/32 анонсируется маршрутизатором R7 в OSPF. Информацию о данном маршруте маршрутизатору R1 будут передавать маршрутизаторы R7-R6-R3.
Напишите, какие типы LSA каждый из маршрутизаторов будет использовать для передачи данной информации? Почему?

*Приведите ответы на вопросы в свободной форме.*
```
В данной сетевой топологии маршрутизатор R7 анонсирует сеть 7.7.7.7/32 в OSPF. Обновления о состоянии этой сети будут передаваться другим маршрутизаторам через использование типов сообщений LSA (Link State Advertisement).

Маршрутизатор R7 будет использовать LSA типа 1 (Router LSA) для передачи информации о своих подключенных сетях и состоянии соединений.
Маршрутизатор R6 будет использовать LSA типа 2 (Network LSA) для объявления о наличии сети и подключенных к ней маршрутизаторах.
Маршрутизатор R3, в свою очередь, будет получать эту информацию и использовать LSA типа 3 (Summary LSA) для передачи сводной информации о маршрутах в OSPF-области.

Таким образом, информация о сети 7.7.7.7/32 будет распространяться с помощью соответствующих типов LSA внутри OSPF-области. Различные типы LSA позволяют эффективно обмениваться информацией о топологии сети между маршрутизаторами и обеспечивать согласованность и актуальность данных о сетевой инфраструктуре.
```
### Задание 5*

Конфигурация типов линков в топологии из Задания 1, задана по умолчанию. У каких линков вы бы изменили тип линка для болеее оптимальной работы протокола OSPF? 

*Приведите ответы на вопросы в свободной форме.*
```
В топологии из задания 1, изменение типов линков OSPF может быть полезным для обеспечения более оптимальной работы протокола OSPF. Ниже приведены несколько ситуаций, где изменение типа линка может быть целесообразным:

1. Точка-точка (Point-to-Point) соединения: Если между маршрутизаторами имеются прямые точка-точка соединения, которые не требуют дополнительной сетевой адресации, изменение типа линка на Point-to-Point может уменьшить избыточность и улучшить сходимость OSPF.

2. Транзитные сегменты: Для сетевых сегментов, через которые проходят данные от нескольких маршрутизаторов, изменение типов линков на типы, отличные от Broadcast, может улучшить производительность и сходимость протокола.

3. Сегменты с высокой пропускной способностью: Для сегментов с высокой пропускной способностью, таких как оптоволоконные линии или высокоскоростные каналы, изменение типа линка на типы, учитывающие высокую пропускную способность, может помочь маршрутизаторам принимать более информированные решения о маршрутизации.

4. Сегменты с ограниченной пропускной способностью: Для сегментов с ограниченной пропускной способностью, таких как общедоступная сеть или сегменты с низкой скоростью передачи данных, изменение типа линка на типы, учитывающие ограниченную пропускную способность, может помочь избежать перегрузок и улучшить управление трафиком.

В целом, изменение типов линков в OSPF следует рассматривать как инструмент оптимизации протокола в зависимости от конкретных требований и особенностей сетевой топологии.

Итак, Я бы изменил тип линка на линке между R2 и R4 на "point-to-point" для более оптимальной работы протокола OSPF. Тип "point-to-point" позволяет OSPF использовать более эффективные методы обнаружения сбоев и обмена информацией, что может улучшить производительность сети.

Также, если пропускная способность линка между R1 и R5 больше, чем сумма пропускных способностей линков на путях R1-R2-R4 и R1-R3-R4, я бы изменил тип линка между R1 и R5 на "point-to-point" для более эффективного использования пропускной способности этого линка.

На линке между R2 и R3 можно также изменить тип линка на "point-to-point", если это соответствует фактической физической конфигурации сети, что также может улучшить работу протокола OSPF.
```


### Совет
Можете использовать симулятор для построения топологии и проверки/поиска ответов на задания. Файл с изначальной конфигурцией указан в Задании 1.

### Правила приема домашнего задания

В личном кабинете отправлены:

- ссылка на документ (Google Doc) с выполненным заданием. В документе настроены права доступа “Просматривать могут все в Интернете, у кого есть ссылка”.

### Критерии оценки

Зачет - выполнены все задания, ответы даны в развернутой форме, приложены соответствующие скриншоты и файлы проекта, в выполненных заданиях нет противоречий и нарушения логики.

На доработку - задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки.
