# Домашнее задание к занятию "Протокол OSPF. Метрика, зоны и суммаризация"

### Цель задания

Данное домашнее задание позволит научиться проектировать динамическую маршрутизацию больших размеров, правильно выбирать тип сети, манипулировать метрикой и управлять выбором лучшего маршрута. Данные знания очень важны для построения качественной и быстрой сети.  

В результате выполнения этого задания вы:

1) Научитесь проектировать мультизональную топологию в OSPF.
2) Научитесь управлять метрикой.
3) Научитесь определять и конфигурировать, какой тип сети необходим для соседства в OSPF.
4) Научитесь определять, какой маршрут будет установлен в таблице маршрутизации.
5) Научитесь определять, какой тип LSA используется для передачи данных о сети.

 
------

### Инструкция к выполнению домашнего задания

1. Сделайте копию [Шаблона для домашнего задания](https://docs.google.com/document/d/1youKpKm_JrC0UzDyUslIZW2E2bIv5OVlm_TQDvH5Pvs/edit) себе на Google Disk.
2. В названии файла введите корректное название лекции и вашу фамилию и имя.
3. Зайдите в “Настройки доступа” и выберите доступ “Просматривать могут все в Интернете, у кого есть ссылка”.
 Ссылка на инструкцию [Как предоставить доступ к файлам и папкам на Google Диске](https://support.google.com/docs/answer/2494822?hl=ru&co=GENIE.Platform%3DDesktop)
5. Скопируйте текст задания в свой документ.
6. Выполните домашнее задание, запишите ответы и приложите необходимые скриншоты в свой Google Doc.
7. Для проверки домашнего задания преподавателем отправьте ссылку на ваш документ в личном кабинете.
8. Любые вопросы по решению задач задавайте в чате учебной группы.

---

### Задание 1

Исходя из топологии на картинке, определите тип всех маршрутизаторов (internal, backbone, ABR).  
Файл с изначальной конфигурацией маршрутизаторов можете найти [здесь]( https://github.com/netology-code/drut-homeworks/blob/main/4-03/homework_4_3_routers_config.txt ) - 

![image](https://github.com/netology-code/drut-homeworks/blob/main/4-03.png)

*Приведите список маршрутизаторов R1, R2, R3, R4, R5, R6, R7 c указанием их типов.*
# Ответ

```
Исходя из предоставленной конфигурации OSPF маршрутизаторов, можно определить тип каждого маршрутизатора в этой топологии.

R1 –  Этот маршрутизатор находится только в зоне 0, поэтому он может быть классифицирован как  (backbone)

R2 – ABR (Area Border Router). Маршрутизатор R2 имеет интерфейсы в областях 0 и 3 OSPF, связывая эти области, поэтому он является маршрутизатором граничащим с областями (ABR).

R3 – ABR (Area Border Router). Маршрутизатор R3 также имеет интерфейсы в нескольких областях OSPF (0, 3 и 7), связывая их между собой, что делает его также ABR.

R4 – Этот маршрутизатор находится только в зоне 3, поэтому он может быть классифицирован как внутренний маршрутизатор (Internal).

R5 –  Этот маршрутизатор так же как R1 находится только в зоне 0, поэтому он может быть классифицирован как  (backbone)

R6 – (Internal). Маршрутизатор R6 имеет все свои интерфейсы в области 7 OSPF. Следовательно, он также может быть определен как (Internal).

R7 – (Internal). Маршрутизатор R7 имеет все свои интерфейсы в области 7 OSPF. Следовательно, он также может быть определен как (Internal).
```

---

### Задание 2

По топологии из Задания 1, определите метрику маршрута на маршрутизаторе R1 для сети 4.4.4.4/32 маршрутизатора R4 через путь R1-R2-R4 и R1-R3-R4. 

1) Какая метрика будет у данных маршрутов?
2) Какой или какие из этих маршрутов будут установлены в таблицу маршрутизатора R1? 
Для оптимальной передачи трафика, маршрут до 4.4.4.4 должен проходить только через R1-R3-R4. 
3) Является ли ситуация в таблице маршрутизации оптимальной? Если нет, то каким образом можно исправить ситуацию и на каких маршрутизаторах необходимо внести изменения?
На маршрутизаторах сделана конфигурация для анонса сети и установления соседства. Дополнительные настройки по умолчанию.

*Приведите ответы на вопросы в свободной форме. В вопросе 3, если необходима конфигурация на маршрутизаторах, то приведите команды, которые необходимо применить и на каких маршрутизаторах.*
```
На схеме представлена сеть с использованием протокола OSPF. Маршрутизаторы R1, R2, R3 и R4 участвуют в обмене маршрутами. Для сетей OSPF метрика маршрута основывается на стоимости (cost), которая по умолчанию рассчитывается как `10000000 / bandwidth_in_bps`.

1. Метрика маршрута на маршрутизаторе R1 для сети 4.4.4.4/32:
- Через путь R1-R2-R4:
  - R1-R2: `10000000 / 100000000` = 100
  - R2-R4: `10000000 / 1000000000` = 10
  - ИТОГО: 100 + 10 = 110

- Через путь R1-R3-R4:
  - R1-R3: `10000000 / 100000000` = 100
  - R3-R4: `10000000 / 1000000000` = 10
  - ИТОГО: 100 + 10 = 110

2. В таблице маршрутизации маршрутизатора R1 будут присутствовать оба маршрута, поскольку их метрика равна. OSPF в таком случае использует равнозначную балансировку нагрузки (Equal-cost multi-path, ECMP), если только не настроены дополнительные ограничения.

3. Таблица маршрутизации не оптимальна, поскольку трафик должен проходить только через маршрут R1-R3-R4. Чтобы исправить ситуацию, необходимо изменить стоимость интерфейсов так, чтобы путь через R3 был предпочтительнее. Например, можно увеличить стоимость интерфейса на маршрутизаторе R1, ведущего к R2.

Команды для маршрутизатора R1:
```
configure terminal
interface Gi0/0 (предполагаемый интерфейс к R2)
ip ospf cost 200
exit
```

Это повысит стоимость маршрута через R2, делая путь R1-R3-R4 предпочтительным.

Реальная конфигурация зависит от используемого оборудования и версии операционной системы маршрутизаторов. Команды 'configure terminal' и 'ip ospf cost' характерны для устройств Cisco.
```
### Задание 3 

По топологии из Задания 1, сеть 172.16.1.0/24 анонсируется в OSPF через R4 и R5. 
1) Какой путь или пути ( R1-R5, R1-R2-R4, R1-R3-R4)  выберет R1 для данного маршрута? Почему? Соседства между R4-R5 нет.
2) Какие метрики для данного маршрута будет у R1 для данного маршрута через каждый путь? Конфигурация по умолчанию.
3) Какие изменения конфигурации необходимо сделать, чтоб правильно учитывалась пропускная способность каждого линка на этих путях?  
4) После того, как будет учитываться правильно каждый линк, изменится ли ситуация с выбором маршрута на R1? Почему?
 
*Приведите ответы на вопросы в свободной форме. В вопросе 3, напишите точно какую/какие команды необходимо использовать на маршрутизаторах*
```
Для определения пути, выбираемого маршрутизатором R1 для сети 172.16.1.0/24 в OSPF, необходимо учитывать OSPF-метрику (стоимость) каждого пути к этой сети. В конфигурации по умолчанию OSPF метрика рассчитывается на основе стоимости сетевых интерфейсов.

Путь R1-R5: Маршрутизатор R5 непосредственно анонсирует сеть 172.16.1.0/24 в OSPF. Поэтому, путь R1-R5 будет иметь наименьшую метрику, так как метрика до R5 будет наименьшей относительно других маршрутов.

Путь R1-R2-R4: Этот путь включает более один хоп и, следовательно, включает в себя сумму метрик каждого сегмента маршрута. Если маршрут R1-R4 имеет меньшую метрику, чем R1-R5, тогда этот путь будет выбран.

Путь R1-R3-R4: Аналогично, для этого пути также будет рассчитываться сумма метрик каждого сегмента пути, и, если этот путь имеет меньшую метрику, чем R1-R5, он будет выбран.

В конфигурации по умолчанию OSPF, метрика для каждого пути будет рассчитываться на основе стоимости интерфейсов, из которых он состоит. Эти метрики могут быть проверены с помощью команды "show ip route" на маршрутизаторе R1 после настроек OSPF.

Чтобы правильно учитывать пропускную способность каждого линка на этих путях, необходимо управлять стоимостью каждого интерфейса OSPF на маршрутизаторах R2 и R3. Для этого можно использовать следующие команды:

R2(config)# interface [интерфейс]
R2(config-if)# ip ospf cost [стоимость]

R3(config)# interface [интерфейс]
R3(config-if)# ip ospf cost [стоимость]

После настройки стоимости интерфейсов OSPF на маршрутизаторах R2 и R3, метрика каждого пути будет пересчитана на маршрутизаторе R1. Если стоимость пересчитанных путей R1-R2-R4 или R1-R3-R4 станет меньше, чем стоимость пути R1-R5, выбор маршрута на маршрутизаторе R1 может измениться. Это произойдет потому, что OSPF будет выбирать маршрут с наименьшей метрикой.

Метрика каждого пути будет рассчитываться заново, и маршрут с наименьшей метрикой будет выбран на маршрутизаторе R1.

Да, определение типа каждого из трех маршрутов влияет на выбор маршрута OSPF. В протоколе OSPF существует концепция типов маршрутов, которая оказывает влияние на процесс выбора наилучшего маршрута.

1. R1-R5: Этот маршрут будет типа "интра-ареальный" (intra-area), так как оба конечных маршрута находятся в одной и той же области OSPF (например, AREA 0), и метрика будет размещена прямо в базе данных OSPF на R1. Этот маршрут будет предпочтительным из-за меньшей стоимости и меньшего количества хопов.

2. R1-R2-R4: Этот маршрут будет типа "между-областной" (inter-area), поскольку маршрут проходит через несколько областей OSPF. В этом случае, метрика маршрута будет рассчитываться на R1 на основе суммарной стоимости каждой области. Если стоимость этого маршрута окажется меньше, он может быть выбран в качестве предпочтительного.

3. R1-R3-R4: Также будет маршрутом типа "между-областной" (inter-area) по той же причине, что и предыдущий маршрут через R2. На R1 метрика этого маршрута также будет рассчитываться на основе суммарной стоимости каждой области.

Изменение типа маршрута может повлиять на выбор маршрута в зависимости от оптимизации стоимости пути на уровне каждой области. OSPF будет выбирать маршрут опираясь на наименьшую метрику, которая учитывает стоимость и количество хопов через каждый маршрут.
```
## Дополнительные задания (со звездочкой*)

Эти задания дополнительные (не обязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.

### Задание 4*

По топологии из Задания 1, сеть 7.7.7.7/32 анонсируется маршрутизатором R7 в OSPF. Информацию о данном маршруте маршрутизатору R1 будут передавать маршрутизаторы R7-R6-R3.
Напишите, какие типы LSA каждый из маршрутизаторов будет использовать для передачи данной информации? Почему?

*Приведите ответы на вопросы в свободной форме.*
```
В данной сетевой топологии маршрутизатор R7 анонсирует сеть 7.7.7.7/32 в OSPF. Обновления о состоянии этой сети будут передаваться другим маршрутизаторам через использование типов сообщений LSA (Link State Advertisement).

Маршрутизатор R7 будет использовать LSA типа 1 (Router LSA) для передачи информации о своих подключенных сетях и состоянии соединений.
Маршрутизатор R6 будет использовать LSA типа 2 (Network LSA) для объявления о наличии сети и подключенных к ней маршрутизаторах.
Маршрутизатор R3, в свою очередь, будет получать эту информацию и использовать LSA типа 3 (Summary LSA) для передачи сводной информации о маршрутах в OSPF-области.

Таким образом, информация о сети 7.7.7.7/32 будет распространяться с помощью соответствующих типов LSA внутри OSPF-области. Различные типы LSA позволяют эффективно обмениваться информацией о топологии сети между маршрутизаторами и обеспечивать согласованность и актуальность данных о сетевой инфраструктуре.
```
### Задание 5*

Конфигурация типов линков в топологии из Задания 1, задана по умолчанию. У каких линков вы бы изменили тип линка для болеее оптимальной работы протокола OSPF? 

*Приведите ответы на вопросы в свободной форме.*
```
Все линки ( broadcast домены ), где только два маршрутизатора, то там можно менять на point-to-point.


```


### Совет
Можете использовать симулятор для построения топологии и проверки/поиска ответов на задания. Файл с изначальной конфигурцией указан в Задании 1.

### Правила приема домашнего задания

В личном кабинете отправлены:

- ссылка на документ (Google Doc) с выполненным заданием. В документе настроены права доступа “Просматривать могут все в Интернете, у кого есть ссылка”.

### Критерии оценки

Зачет - выполнены все задания, ответы даны в развернутой форме, приложены соответствующие скриншоты и файлы проекта, в выполненных заданиях нет противоречий и нарушения логики.

На доработку - задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки.
