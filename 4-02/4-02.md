# Домашнее задание к занятию "Протокол OSPF. Построение соседства, машина состояний, LSDB"

### Цель задания

Данное домашнее задание научит вас базовой настройке протокола OSPF, что является очень важным для любого сетевого администратора. Вы научитесь организовывать динамическую маршрутизацию как в малых, так и больших сетях. Конфигурация и диагностика, изученные в данном задании, необходимы почти всегда при работе c OSPF.  

В результате выполнения этого задания вы:
1. Научитесь выполнять конфигурацию OSPF.
2. Научитесь исследовать процесс установления соседства.
4. Проанализируете процесс выбора DR/BDR.
5. Научитесь проводить диагностику работы протокола.

------

### Инструкция к выполнению домашнего задания

1. Сделайте копию [Шаблона для домашнего задания](https://docs.google.com/document/d/1youKpKm_JrC0UzDyUslIZW2E2bIv5OVlm_TQDvH5Pvs/edit) себе на Google Disk.
2. В названии файла введите корректное название лекции и вашу фамилию и имя.
3. Зайдите в “Настройки доступа” и выберите доступ “Просматривать могут все в Интернете, у кого есть ссылка”.
 Ссылка на инструкцию [Как предоставить доступ к файлам и папкам на Google Диске](https://support.google.com/docs/answer/2494822?hl=ru&co=GENIE.Platform%3DDesktop)
5. Скопируйте текст задания в свой документ.
6. Выполните домашнее задание, запишите ответы и приложите необходимые скриншоты в свой Google Doc.
7. Для проверки домашнего задания преподавателем отправьте ссылку на ваш документ в личном кабинете.
8. Любые вопросы по решению задач задавайте в чате учебной группы.

## Лабораторная работа "Базовая конфигурация протокола OSPF"


### Подготовка

1. Запустите Cisco Packet Tracer. 
2. Скачайте файл топологии из [папки с заданием](https://github.com/netology-code/drut-homeworks/tree/main/4-02) или постройте топологию сами по картинке. 

![image](https://user-images.githubusercontent.com/85602495/149903430-5ec488cc-9e2e-4633-b60a-9ddd3e693877.png)

------

### Задание 1. Запуск протокола OSPF 

Запустите протокол OSPF:  
 - Анонсируйте ip адреса Fa0/0, Fa0/1 и Loopback 0 в Area 0;
 - Проверьте наличие маршрутов OSPF в таблице маршрутизации;
 - Проверьте наличие связности всех Loopback адресов со всех маршрутизаторов.
 
*Выполните необходимую конфигурацию и приложите список сделанных команд для каждого маршрутизатора.*
  # Ответ
  ```
Router1:
router ospf 123
network 192.168.1.0 0.0.0.255 area 0
network 1.1.1.0 0.0.0.255 area 0
int loopback 11
ip address 11.11.11.11 255.255.255.255
router ospf 123
network 11.11.11.11 0.0.0.0 area 0
do sh ip ospf int br
show ip ospf database
show ip ospf neighbor

Router2:
router ospf 222
interface range fastEthernet 0/0-1
ip ospf 222 area 0
int lo0
ip ospf 222 area 0
show ip ospf neighbor

Router3#
show ip int br
router ospf 1
network 0.0.0.0 255.255.255.255 area 0
show ip ospf neighbor

Router4:
router ospf 1
int lo0
ip ospf 1 area 0
int fastEthernet 0/1
ip ospf 1 area 0
int fastEthernet 0/0
ip ospf 1 area 0
show ip ospf neighbor
```

------

### Задание 2. Проверка построения соседства

1. Выключите интерфейс Fa0/0 на одном из маршрутизаторов, подождите 40 секунд.  
2. Включите Packet Simulation в Packet Tracer на этом порту.  
3. Включите интерфейс и посмотрите процесс установления соседства на пакетном уровне.  
В данных пакетах OSPF найти поле AreaID. В каких пакетах передается AreaID? В каком формате передается?

*Выполните необходимую конфигурацию и приведите ответы на вопросы в свободной форме.*
 # Ответ

```
В протоколе OSPF, поле AreaID передается в двух типах пакетов: "Hello packets" (приветственные пакеты) и "Database Description packets" (пакеты описания базы данных).

В "Hello packets" поле AreaID передается для идентификации области OSPF, к которой относится отправитель пакета. Это помогает соседним маршрутизаторам определить, принадлежат ли они к одной и той же области.

В "Database Description packets" поле AreaID также передается для указания области, к которой относится информация, предоставляемая в этом пакете.

AreaID передается в формате 32-битного числа, представленного в десятичной или десятично-шестнадцатеричной форме. Например, область "0" будет представлена как "0.0.0.0" в десятичном формате или "0x0" в шестнадцатеричном формате.
```
------
### Задание 3. Оповещение соседей о потерянном маршруте

После установления соседства, отключите Loopback 0 на Router4 и посмотрите, каким образом произойдет оповещение соседей о потере маршрута. Посредством чего OSPF маршрутизатор
оповещает соседей о потерянном маршруте?

*Приведите ответы на вопросы в свободной форме.*
 # Ответ
```
Когда маршрутизатор обнаруживает потерю сетевого маршрута, он сообщает об этом своим соседям в OSPF с помощью отправки LSA (Link State Advertisement) типа 3, которые представляют обзор состояния маршрутов для конкретных областей.

В данном случае, после отключения интерфейса Loopback 0, маршрутизатор OSPF заметит изменение в состоянии инцидента и начнет процесс оповещения соседей о потере маршрута, используя механизм LSA типа 3. Когда это происходит, все соседи OSPF получат обновленные LSA типа 3, которые указывают на изменения в топологии сети, включая потерю маршрута через Loopback 0.

Эти LSA будут распространяться через область OSPF, и все маршрутизаторы в этой области обновят свои таблицы маршрутизации, чтобы учесть потерю маршрута через Loopback 0. Таким образом, OSPF использует механизмы LSA для оповещения соседей о потерянных маршрутах и для обновления информации о топологии сети.

Когда происходит потеря маршрута в сети OSPF из-за отключения интерфейса или другой причины, OSPF-маршрутизатор оповещает соседей об этой потере путем отправки сообщений типа LSA (Link State Advertisement), которые содержат информацию о топологических изменениях в сети.

В нашем случае, при отключении Loopback 0 на Router4, произойдет следующее: OSPF-маршрутизатор Router4 обнаружит потерю маршрута к Loopback 0 и создаст LSA сообщение, содержащее информацию об этой потере. Затем Router4 отправит это LSA сообщение всем своим соседям OSPF, чтобы обновить их таблицы маршрутизации. Соседи примут это LSA сообщение, обновят свои таблицы маршрутизации и возможно запустят процесс пересчета маршрутов.

Таким образом, OSPF использует LSA сообщения для оповещения соседей о потерянных маршрутах, и этот механизм обеспечивает сетевую согласованность и быстрое обновление маршрутов в случае возникновения проблем в сети.

LSA (Link State Advertisement) - это не тип сообщения, а элемент базы данных, используемый в протоколе OSPF для хранения информации о топологии сети. Типы сообщений, которые передаются в рамках OSPF и используют LSA для обмена информацией перечислю ниже:

В протоколе OSPF (Open Shortest Path First) существуют несколько типов сообщений LSA (Link State Advertisement), предназначенных для передачи различных аспектов топологии сети. Вот основные типы сообщений LSA в OSPF:

1. Router LSA (тип 1): Хранит информацию о линках (интерфейсах) маршрутизатора и состоянии соседства OSPF. Распространяется каждым маршрутизатором внутри его области OSPF.

2. Network LSA (тип 2): Это сообщение создается DR (Designated Router) для каждой сегментированной сети. Содержит список всех маршрутизаторов, связанных с этой трансляцией, а также соответствующие интерфейсы.

3. Summary LSA (тип 3): Используется для передачи информации о маршрутах к сетям, находящимся вне области, в другие области OSPF.

4. ASBR Summary LSA (тип 4): Этот тип LSA содержит информацию о маршрутах к ASBR (Autonomous System Border Router), которые затем могут быть использованы для достижения сетей вне текущего автономной системы.

5. External LSA (тип 5): Этот тип LSA содержит информацию о внешних маршрутах или маршрутах к сетям, не принадлежащим к текущей автономной системе OSPF.

6. NSSA LSA (тип 7): Используется в области NSSA (Not So Stubby Area) для передачи информации о внешних маршрутах в этой области.

Каждый из этих типов LSA направлен на обеспечение связности и обновления таблиц маршрутизации в рамках протокола OSPF и способствует построению и поддержанию актуальной сетевой топологии.

LSA это часть LSDB, а не тип сообщения. Тип сообщения это Hello, DBD, Update и т.д. . Именно в LS Update отправляется целиком любой LSA.
```

------

### Задание 4. Определение DR и BDR

Сделайте предположение, какие маршрутизаторы будут выбраны в качестве DR и BDR.  Узнайте, какие маршрутизаторы выбраны DR и BDR в реальности при помощи команд на маршрутизаторе. 
Какую команду необходимо использовать для получения информации о DR/BDR? Сошлись ли предположения с реальностью? Если нет, то почему?

*Приведите ответы на вопросы в свободной форме.*
 # Ответ
```
Предположения о выборе DR (Designated Router) и BDR (Backup Designated Router) в сети OSPF могут базироваться на рассмотрении идентификаторов маршрутизаторов (Router ID), приоритетов интерфейсов и активности на соседних интерфейсах. Обычно, маршрутизаторы с более высоким Router ID имеют большие шансы быть выбранными в качестве DR и BDR, если ослаблен приоритет на интерфейсах.

Для получения информации о DR и BDR в OSPF можно использовать команду "show ip ospf neighbor", которая покажет информацию о соседях OSPF, включая их состояние и роли (DR, BDR или обычный).

Если в реальности предполагаемые маршрутизаторы были выбраны в качестве DR и BDR, это может быть связано с высокими Router ID или определенными настройками приоритета. Однако, реальное определение DR и BDR может быть осложнено другими факторами, такими как настройки приоритетов, активность соседних интерфейсов, предварительные настройки DR и BDR или наличие других маршрутизаторов с аналогичными характеристиками.

Помимо этого, важно отметить, что в некоторых сетевых конфигурациях администраторы сети могут вручную настраивать особенности выбора DR и BDR, что может привести к отклонениям от предполагаемых результатов.
```
------

### Задание 5. Диагностика работы протокола

1. Какой командой узнать RouterID?
2. Какой командой узнать список анонсированных сетей?
3. Какой командой узнать список соседей?
4. Какой командой узнать список интерфейсов, на которых активирован OSPF?
5. Какой командой перезапустить процесс OSPF?

*Приложите список сделанных команд.* 
  # Ответ
```
1. Для того чтобы узнать Router ID, можно использовать команду "show ip ospf", в ответе будет приведена информация о Router ID.

2. Для того чтобы узнать список анонсированных сетей, можно использовать команду "show ip ospf database external".

3. Для того чтобы узнать список соседей, можно использовать команду "show ip ospf neighbor".

4. Для того чтобы узнать список интерфейсов, на которых активирован OSPF, можно использовать команду "show ip ospf interface".

5. Для перезапуска процесса OSPF, можно использовать команду "clear ip ospf process". Эта команда выведет процесс OSPF из строя и затем автоматически восстановит его, применяя все текущие настройки.
```

### Правила приема домашнего задания

В личном кабинете отправлена ссылка на документ (Google Doc) с выполненным заданием. В документе настроены права доступа “Просматривать могут все в Интернете, у кого есть ссылка”.

---

### Критерии оценки

Зачет - выполнены все задания, ответы даны в развернутой форме, приложены соответствующие скриншоты и файлы проекта, в выполненных заданиях нет противоречий и нарушения логики.

На доработку - задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки.

